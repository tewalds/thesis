% vim: set wrap

  % Titlepage
  \pdfbookmark[0]{Prefatory Pages}{prefatory}
  \pdfbookmark[1]{Title}{title}
%  \vspace{.25in}
%  \title{
  \begin{center}
    \Large{\textbf{\school}}  \\ [.6in]
    \Large{\textbf{\thesistitle}} \\ [.1in]
    \normalsize{by} \\ [.1in]
    \Large{\textbf{\name}}  \\ [.6in]
    \normalsize{A thesis submitted to the Faculty of Graduate Studies and Research \\
    in partial fulfillment of the requirements for the degree of} \\ [0.1in]
    \Large{\textbf{\program}} \\ [.1in]
    \normalsize{\dept} \\ [0.6in]
    \scriptsize{\copyright\:\name} \\
    \scriptsize{\semester} \\
    \scriptsize{Edmonton, Alberta} \\ [0.6in]
    % DO NOT modify this text, it is a requirement
    \scriptsize{Permission is hereby granted to the University of Alberta Libraries to reproduce single copies of this thesis and to lend or sell such copies for private, scholarly or scientific research purposes only. Where the thesis is converted to, or otherwise made available in digital form, the University of Alberta will advise potential users of the thesis of these terms.

The author reserves all other publication and other rights in association with the copyright in the thesis and, except as herein before provided, neither the thesis nor any substantial portion thereof may be printed or otherwise reproduced in any material form whatsoever without the author's prior written permission.}
  \end{center}

  % Examining committee page
  \newpage
  % Begin numbering the pages with Roman numerals
  \pdfbookmark[1]{Examining Committee}{examining}
  \chapter*{Examining Committee}
  \thispagestyle{empty}
     \supervisor, \; \superloc \\ \\
     \coma, \; \loca \\ \\
     \comb, \; \locb \\ \\
     \comc, \; \locc \\ \\
     \comd, \; \locd \\ \\
     \come, \; \loce


  % Dedication
%   \newpage
%  \pdfbookmark[1]{Dedication}{dedication}
%  \chapter*{}
%  \thispagestyle{empty}
%  This thesis is dedicated to\\
%  A person or persons or perhaps some abstract concept.

  % Abstract
  \newpage
  \pdfbookmark[1]{Abstract}{abstract}
  \chapter*{Abstract}
  \thispagestyle{empty}
  \vspace*{-0.7in}
  \renewcommand{\baselinestretch}{1.8}
  \normalsize{

Havannah is a recent game that is interesting from an AI research perspective. Some of its properties, including virtual connections, frames, dead cells and draws are explained. Monte Carlo Tree Search (MCTS) is well suited to play Havannah, but the playing strength can be improved by using heuristic knowledge and a modified rollout policy. A change to the rules in the rollout policy significantly improves play. Combined with several Havannah specific heuristics, a greater than 80\% winning rate, or 300 elo gain, is achieved on all board sizes over an already fairly strong player. This MCTS player is augmented with a few engineering improvements and then used to solve all 6 openings of size 4 Havannah, a game with a state space on the order of $6 \times 10^{15}$ states. Castro, the implementation and test bed, is released open source.

  }

% A second paragraph if you need it
%  \vspace*{-0.2in} \\
%  \normalsize{
%  This is a second abstract paragraph. if you need it.
%  }
  \renewcommand{\baselinestretch}{1.33}

  % Preface
  \newpage
  \pdfbookmark[1]{Preface}{preface}
  \chapter*{Preface}
  \thispagestyle{empty}
  \vspace*{-0.7in}

I've never been very good or interested in playing board games, but I've always had a fascination with how to play them well. I started programming when I was 13 years old, and one of my first projects was to write an AI for tic-tac-toe. This is rather easy, as the game is tiny, but it was a good project for teaching me to program. A few years later I was introduced to mancala, and as a way to understand the game better, I decided to write a program to play it, and in the process, independently reinvented minimax and rediscovered that many games are zero-sum. My mancala program was never any good as I didn't know anything about alpha-beta and wikipedia hadn't been invented yet, but I have always had a greater interest in understanding how the mechanics of the game work than actually playing the game. Writing a strong program is a great challenge, and a very satisfying one if your program becomes a stronger player than you are yourself.

In late 2008 I was introduced to Pentago, an interesting game invented in 2005. It is a 2-player game played on a 6x6 board where each turn is composed of placing a stone and rotating a 3x3 quadrant with the goal of forming 5 in a row. After playing a few rounds and losing badly, I decided to figure out how to write a program to play it so that I could better understand the strategy and tactics. During a few rounds of play I devised a simple heuristic, which on its own is very weak, but when used with alpha-beta is quite strong. With some optimization, my program, Pentagod, became strong enough to easily crush me and my friends.

In early 2010, while taking a computer science course in computer game AI with Martin Mueller, I was tasked with writing a program to play Havannah. Basing my program, Castro, on my earlier work on Pentagod, my program became reasonably strong by program standards, but still quite weak by human standards. In fact, Christian Freeling, the creator of Havannah was so certain that programs would remain weak that he issued a challenge for \euro 1000 to anyone who can beat him in only one in ten games on size 10 by 2012. I continued working on my program after the course finished, implementing techniques mentioned in class or used in other games, trying to use the theoretical properties used in the related game Hex, optimizing my code for pure efficiency and parallelism, and coming up with Havannah specific techniques. In September 2010 I went to Kanazawa Japan to compete in the Computer Games world championship and won 15 out of 16 games, winning the tournament. Soon after I attempted to solve size 4, a small version of the game, and succeeded in January 2011.

This thesis is the story of what it takes to write a strong Havannah player, and how this player was used as the basis of solving size 4 Havannah. Chapter \ref{intro} introduces some of the concepts and motivations for this thesis. Chapter \ref{background} explains the required background knowledge for the algorithms used in the rest of thesis. Chapter \ref{havannah} describes the rules of the game and introduces several properties of the game itself that make writing a program challenging, and a few that can be exploited to increase the playing strength. Chapter \ref{playing} explains how the general techniques were adapted to Havannah and introduces a few Havannah specific heuristics that together lead to a tournament level program. Chapter \ref{solving} explains how the player was used to solve size 4 Havannah and the extra techniques needed to accomplish this goal along with the solution to size 4 Havannah. Chapter \ref{conclusion} provides a summary, and described possible future work.



  % Acknowledgements
  \newpage
  \pdfbookmark[1]{Acknowledgements}{acknowledgements}
   \chapter*{Acknowledgements}
   \thispagestyle{empty}
   \vspace*{-0.7in}
   \small{

I'd especially like to thank Colin Ophus, for playing so many games of Pentago and Havannah with me, and trying to deconstruct the games. His insights and enthusiasm helped me stay motivated and continually improve Castro. Also, I appreciate the thesis template and thesis advice.

Thank you Ryan Hayward, Martin Mueller and Jonathan Schaeffer, for your insights into game playing algorithms, how they apply to other games and possibly to Havannah, and for advising me on my thesis.

Thank you Marcin Ciura for your havannah.sty which made the havannah diagrams easy, and the constant discussion of Havannah ideas.

Thanks to my family and friends, for their constant support as I worked on my masters.

Thank you Christian Freeling, for inventing such an interesting game.

   }

